<div class="main-content">

  <div class="header">
    <p>Lista de Projetos</p>
  </div>

  <div class="dash">
    <div [nzGutter]="8" nz-row>
      <div nz-col [nzSpan]="8">
        <nz-card nzTitle="Total Projetos"><p>{{ totalProjetos }}</p></nz-card>
      </div>
      <div nz-col [nzSpan]="8">
        <nz-card nzTitle="Em Andamento"><p>{{ totalProjetosEmAndamento }}</p></nz-card>
      </div>
      <div nz-col [nzSpan]="8">
        <nz-card nzTitle="Concluídos"><p>{{ totalProjetosConcluidos }}</p></nz-card>
      </div>
    </div>
  </div>

  <div class="filter">
    <input nz-input placeholder="Pesquisar..." [(ngModel)]="searchValue" (ngModelChange)="search()" />
    <button nz-button nzType="primary" (click)="openDrawer()">Novo Projeto</button>
  </div>

  <div class="table-container">
    <nz-table [nzData]="projetos" [nzScroll]="{x: '800px', y: '280px'}">
      <thead>
      <tr>
        <th>Nome</th>
        <th>Descrição</th>
        <th>Data Início</th>
        <th>Data Fim</th>
        <th>Status</th>
        <th>Criado em</th>
        <th>Ações</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let projeto of projetos">
        <td>{{ projeto.nome }}</td>
        <td>{{ projeto.descricao }}</td>
        <td>{{ projeto.dataInicio }}</td>
        <td>{{ projeto.dataFim }}</td>
        <td>
          <nz-tag [nzColor]="projeto.status === 'EM_ANDAMENTO' ? 'blue' : 'green'">{{ projeto.status }}</nz-tag>
        </td>
        <td>{{ projeto.createdAt | date: 'dd/MM/yyyy HH:mm' }}</td>
        <td>
          <button nz-button nzType="link" (click)="editProjeto(projeto)">
            <nz-icon nzType="edit"></nz-icon>
          </button>
          <button nz-button nzType="link" nzDanger (click)="deleteProjeto(projeto)">
            <nz-icon nzType="delete"></nz-icon>
          </button>
        </td>
      </tr>
      </tbody>
    </nz-table>
  </div>
</div>

<!-- Drawer -->
<nz-drawer
  [nzVisible]="isDrawerVisible"
  [nzTitle]="drawerTitle"
  [nzWidth]="480"
  [nzFooter]="nzDrawerFooter"
  (nzOnClose)="closeDrawer()">
  <form nz-form *nzDrawerContent [formGroup]="projetoForm">
    <nz-form-item>
      <nz-form-label nzRequired>Nome</nz-form-label>
      <nz-form-control><input nz-input formControlName="nome" placeholder="Nome do projeto" /></nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-label nzRequired>Descrição</nz-form-label>
      <nz-form-control><input nz-input formControlName="descricao" placeholder="Descrição" /></nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-label nzRequired>Data Início</nz-form-label>
      <nz-form-control><input nz-input formControlName="dataInicio" type="date" /></nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-label nzRequired>Data Fim</nz-form-label>
      <nz-form-control><input nz-input formControlName="dataFim" type="date" /></nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-label nzRequired>Status</nz-form-label>
      <nz-form-control>
        <nz-select formControlName="status">
          <nz-option nzValue="EM_ANDAMENTO" nzLabel="Em Andamento"></nz-option>
          <nz-option nzValue="CONCLUIDO" nzLabel="Concluído"></nz-option>
        </nz-select>
      </nz-form-control>
    </nz-form-item>
  </form>

  <ng-template #nzDrawerFooter>
    <button nz-button (click)="closeDrawer()">Cancelar</button>
    <button nz-button nzType="primary" [disabled]="!projetoForm.valid" (click)="submitProjeto()">Salvar</button>
  </ng-template>
</nz-drawer>
